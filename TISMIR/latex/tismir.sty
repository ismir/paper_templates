% Latex Paper Template for TISMIR
%
% Version 20170212
% Fix unnumbered sections for titlesec 2.10.1 users
% Francisco Rodríguez-Algarra
%
% Version 20170211
% Adapted ISMIR 2017's paper template to TISMIR requirements.
% Francisco Rodríguez-Algarra and Stefan Balke
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Layout and Page Margins
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\setlength{\paperheight}{297mm}
\setlength{\paperwidth}{210mm}
\setlength{\textheight}{243mm}
\setlength{\textwidth}{172mm}
\setlength{\columnsep}{5mm}
\setlength{\voffset}{-14mm}
\setlength{\hoffset}{0mm}
\setlength{\marginparwidth}{0mm}
\setlength{\parindent}{1pc}
\setlength{\topmargin}{-2mm}
\setlength{\oddsidemargin}{-6mm}
\setlength{\evensidemargin}{-6mm}
\setlength{\headsep}{12mm}

\setlength\normallineskip{0.5\p@}
\setlength\parskip{0\p@ \@plus \p@}
\setlength{\belowcaptionskip}{-3mm}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Fonts
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\usepackage{inconsolata}
\usepackage{fourier}
\usepackage{quattrocento}
\usepackage{charter}

\def\normalsize{\@setsize\normalsize{12pt}\xpt\@xpt}
\def\small{\@setsize\small{10pt}\ixpt\@ixpt}
\def\footnotesize{\@setsize\footnotesize{9pt}\viiipt\@viiipt}
\def\scriptsize{\@setsize\scriptsize{8pt}\viipt\@viipt}
\def\tiny{\@setsize\tiny{7pt}\vipt\@vipt}
\def\large{\@setsize\large{14pt}\xiipt\@xiipt}
\def\Large{\@setsize\Large{16pt}\xivpt\@xivpt}
\def\LARGE{\@setsize\LARGE{20pt}\xviipt\@xviipt}
\def\huge{\@setsize\huge{24pt}\xxpt\@xxpt}
\def\Huge{\@setsize\Huge{28pt}\xxvpt\@xxvpt}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Abstract
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\usepackage{abstract}
\renewcommand{\abstractnamefont}{\large\sf\bfseries}
\renewcommand{\abstracttextfont}{\sf\large}
\renewcommand{\absnamepos}{flushleft}
\setlength{\absleftindent}{0pt}
\setlength{\absrightindent}{0pt}
\setlength{\absparsep}{0.5em plus 0.2em minus 0.2em}
\setlength{\abstitleskip}{-1.5em}

\parindent = 0em
\AtBeginDocument{\parindent = 1.5em}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Keywords
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\def\keywords{%
\vspace{-.6em}\rule{\textwidth}{0.6pt}\vspace{.3em}
\large {\sf \bfseries Keywords:\,\relax}\sf}
\def\endkeywords{\\\rule{\textwidth}{0.6pt}\par\vspace{1.0em}}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Title and Section Layout
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\usepackage{titling}
\pretitle{\vspace{-3.5em}\begin{flushleft}\sf\bfseries\huge}
\posttitle{\par\end{flushleft}}
\preauthor{\begin{flushleft}\Large\sf}
\postauthor{\par\end{flushleft}\vspace{-5.5em}}

\usepackage{titlesec}

%%
% Fix for titlesec 2.10.1 users
%%
\@ifpackagelater{titlesec}{2016/03/21}{%
 % Package titlesec is on version 2.10.2 or higher, nothing to do %
}{%
 % Check if package titlesec is on version 2.10.1 %
 \@ifpackagelater{titlesec}{2016/03/15}{%
  % Package titlesec on version 2.10.1, patch accordingly %
  \usepackage{etoolbox}%
  \patchcmd{\ttlh@hang}{\parindent\z@}{\parindent\z@\leavevmode}{}{}%
  \patchcmd{\ttlh@hang}{\noindent}{}{}{}%
 }{%
  % Package titlesec is on version 2.10.0 or lower, nothing to do %
 }%
}
%%

\titleformat{\section}
  {\large\sf\bfseries}{\thesection.}
  {8pt \@plus.2ex}{}[]

\titleformat{\subsection}
  {\sf\bfseries}{\thesubsection}
  {8pt \@plus.2ex}{}[]

\titleformat{\subsubsection}
  {\itshape}{\thesubsubsection}
  {8pt \@plus.2ex}{}[]

\titlespacing*{\section}
  {0pt}{2ex}{0pt}

\titlespacing*{\subsection}
  {0pt}{2ex}{0pt}

\titlespacing*{\subsubsection}
  {0pt}{2ex}{0pt}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Paper Information Variables
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\def\thetitleref{\@title}
\def\thetitleshort{\@title}
\newcommand{\titleshort}[1]{\def\thetitleshort{#1}}

\def\theauthorref{\@author}
\newcommand{\authorref}[1]{\def\theauthorref{#1}}

\def\theauthorshort{\@authorref}
\newcommand{\authorshort}[1]{\def\theauthorshort{#1}}

\def\thejournal{Transactions of the International
    Society for Music Information Retrieval}

\def\theyear{\the\year}
\newcommand{\journalyear}[1]{\def\theyear{#1}}

\def\thevolume{V}
\newcommand{\journalvolume}[1]{\def\thevolume{#1}}

\def\theissue{N}
\newcommand{\journalissue}[1]{\def\theissue{#1}}

\def\thepages{xx--xx}
\newcommand{\journalpages}[1]{\def\thepages{#1}}

\def\thedoi{xx.xxxx/xxxx.xx}
\newcommand{\doi}[1]{\def\thedoi{#1}}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Title Block
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\newcommand{\thetype}{}
\newcommand{\type}[1]{\renewcommand{\thetype}{#1}}
\makeatletter
\newcommand{\typename}{\@nameuse{type@\thetype @name}}
\newcommand{\settype}[2]{%
  \@namedef{type@#1@name}{#2}%
}
\makeatother

\settype{}{article type}
\settype{research}{research\ article}
\settype{overview}{overview\ article}
\settype{dataset}{dataset}


\def\maketitleblock{
\vskip 0.6em
\textsf{\bfseries \large \MakeUppercase \typename}
\maketitle
%
\rule{\textwidth}{0.4pt}
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Headers
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\usepackage{fancyhdr}
\setlength{\headheight}{40pt} 

% adjust pagestyle "plain" which is used on the first page
\fancypagestyle{plain}{%
  \fancyhf{}
  \renewcommand{\headrulewidth}{0.6pt}

\fancyhead[L]{%
    \begin{minipage}{0.35\textwidth}
    % \sf \small \thejournal 
    \includegraphics[width=0.85\textwidth]{tismir}
  \end{minipage}
  \hfill
  \begin{minipage}{0.55\textwidth} \sf \small
    \theauthorref\ (\theyear).
    \thetitleref,
    \textit{\thejournal}, \thevolume(\theissue),
    pp.\ \thepages, DOI: https://doi.org/\thedoi
  \end{minipage}
  \vspace{0.5em}
  }
}

% pagestyle "fancy" is used in the rest of the document
\pagestyle{fancy}
\renewcommand{\headrulewidth}{0pt}
\fancyhf{}
\fancyhead[L]{%
{\sf \thepage}
}
\fancyhead[R]{%
{\sf \theauthorshort: \thetitleshort}
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Footnotes and Endnotes
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\usepackage{footmisc}
\renewcommand*{\footnotelayout}{\sffamily}

\usepackage{xpatch}
\usepackage{endnotes}

\renewcommand{\notesname}{Notes}
\renewcommand{\enotesize}{\normalsize}
\renewcommand\enoteformat{%
  \leftskip=0.3em
  \makebox[0pt][r]{\textsuperscript{\footnotesize \theenmark}
    \hskip 0.2em\rule{0pt}{\dimexpr\ht\strutbox}}%
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Captions
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\usepackage[labelfont=bf]{caption}
\captionsetup{format=hang, indention=-3em}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Lists
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\usepackage{enumitem}
\setlist{nolistsep}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% References
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\usepackage{natbib}
\bibliographystyle{apalike}
\setlength{\bibsep}{0pt plus 0.3ex}
\setlength{\bibhang}{2em}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Alignment
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\flushbottom
\sloppy

\usepackage[switch]{lineno}
\DeclareOption{review}{\linenumbers}
\DeclareOption*{\PackageWarning{tismir}{Unknown ‘\CurrentOption’}}
\ProcessOptions\relax
